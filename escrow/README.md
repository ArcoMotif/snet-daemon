## Signatures used for Authorization in Daemon

<BR>
<BR>


| Type of Request | Check for State or Execute Service                                                             | Block chain Mode | allowed User Flag | Request                     | Signature expected                                                                                                                                                | Method Called                                                                 | Response sent             | Comments                                                                                           |
|-----------------|------------------------------------------------------------------------------------------------|------------------|-------------------|-----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|---------------------------|----------------------------------------------------------------------------------------------------|
| Paid Call       | [State](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto) | Enabled          | NA                | [message ChannelStateRequest](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto#L20-L30) | [Signature](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.go#L79-L84)| [rpc GetChannelState\(ChannelStateRequest\) returns \(ChannelStateReply\) \{\}](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto#L14-L17) | [message ChannelStateReply](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto#L36-L53) | Only channel signer/sender/receiver can get latest channel state . Current Block Number passed needs to be +-10 from the block number retrieved by Daemon |
| Paid Call       | [State](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto) | Disabled          | NA                | [message ChannelStateRequest](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto#L20-L30) | [Signature](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.go#L79-L84)| [rpc GetChannelState\(ChannelStateRequest\) returns \(ChannelStateReply\) \{\}](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto#L14-L17) | [message ChannelStateReply](https://github.com/singnet/snet-daemon/blob/master/escrow/state_service.proto#L36-L53) |  Same response is sent every time,Caller would not know if the block chain mode is enabled or disabled |
|Paid Call|Execute Service |Enabled|Disabled|Metadata Passed to Daemon should consist below [headers](https://github.com/singnet/snet-daemon/blob/master/handler/interceptors.go#L24-L43)<br> "snet-payment-type"="escrow" <br>"snet-payment-channel-id" = "Channeld"<br> "snet-payment-channel-nonce"="Nonce"<br> "snet-payment-channel-amount" ="TotalAmount"<br> "snet-payment-channel-signature-bin"="Signature"|[Signature](https://github.com/singnet/snet-daemon/blob/3fb726ac903888efd03de4443f06a5cd294ae9f9/escrow/validation.go#L173-L179)|Call to the method in Service |Response sent by Service |Only channel signer/sender can sign.<br>, Please note the Total Amount = Amount (retrieved from State call) + Price of the current call , latest nonce is also retrieved from the state call |
|Paid Call|Execute Service |Enabled|Enabled |Metadata Passed to Daemon should consist of the below, for [details on headers](https://github.com/singnet/snet-daemon/blob/master/handler/interceptors.go#L24-L43)<br>"snet-payment-type" = "escrow"<br>"snet-payment-channel-id" = "<Channeld>"<br>"snet-payment-channel-nonce" = "<Nonce>"<br>"snet-payment-channel-amount" = "<AmountSigned>"<br>"snet-payment-channel-signature-bin"= "<Signature>"|[Signature](https://github.com/singnet/snet-daemon/blob/3fb726ac903888efd03de4443f06a5cd294ae9f9/escrow/validation.go#L173-L179)|Call to the method in Service |Response sent by Service |Only channel signer/sender can sign .<br>Make sure the Signer is also in the list of allowed users defined in the Daemon config.<br>Please note the [allowed user flag](https://github.com/singnet/snet-daemon/blob/master/README.md#allowed_users_flag) is applicable only in test networks like ropsten / kovan etc; but not in mainnet  |

